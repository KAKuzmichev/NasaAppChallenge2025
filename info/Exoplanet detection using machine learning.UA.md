
# «Exoplanet Detection Using Machine Learning» 
[Виявлення екзопланет за допомогою машинного навчання](https://doi.org/10.1093/mnras/stab3692).

`Advance Access publication 2021 December 21 
Виявлення екзопланет за допомогою машинного навчання
Абхішек Малік, Бенджамін П. Мостер та Крістіан Обермайєр
`
 

### АНОТАЦІЯ
Ми представляємо нову техніку виявлення екзопланет на основі машинного навчання, яка використовує транзитний метод. 
Методи машинного та глибокого навчання довели свою широку придатність у різних галузях наукових досліджень. 
Ми прагнемо використати деякі з цих методів для вдосконалення традиційних алгоритмічних підходів, які зараз 
застосовуються в астрофізиці для виявлення екзопланет. Використовуючи бібліотеку аналізу часових рядів TSFRESH для 
аналізу кривих блиску, ми виділили 789 ознак з кожної кривої, які фіксують інформацію про її характеристики. 
Потім ми використали ці ознаки для навчання класифікатора градієнтного бустингу за допомогою інструменту машинного 
навчання LIGHTGBM. Цей підхід був протестований на даних K2 кампанії 7 з введеними штучними транзитними сигналами, 
що показало його конкурентоспроможність порівняно з традиційним методом підгонки найменших квадратів боксу 
(box least-squares fitting). Ми також виявили, що наш метод дав порівнянні результати з існуючими передовими 
моделями глибокого навчання, будучи при цьому набагато ефективнішим з точки зору обчислень і не вимагаючи згорнутих 
та вторинних представлень кривих блиску. Для даних Kepler метод здатен передбачити планету з AUC 0.948, що означає, 
що 94.8 відсотка справжніх планетарних сигналів ранжуються вище, ніж непланетарні сигнали. Отримана повнота (recall) 
становить 0.96, отже, 96 відсотків реальних планет класифікуються як планети. Для даних Transiting Exoplanet Survey 
Satellite (TESS) ми виявили, що наш метод може класифікувати криві блиску з точністю 0.98 і здатен ідентифікувати 
планети з повнотою 0.82 при точності (precision) 0.63.


**Ключові слова**: методи: аналіз даних - методи: фотометрія - планети та супутники: виявлення.

## 1. ВСТУП
З часу відкриття перших екзопланет (Wolszczan & Frail 1992; Mayor & Queloz 1995) сфера виявлення планет стала важливою 
дослідницькою галуззю в астрофізиці. На сьогоднішній день було відкрито понад 4000 екзопланет за допомогою різних 
методів. Проте більшість підтверджених екзопланет було відкрито за допомогою транзитного методу.

Для транзитного методу яскравість зірки безперервно спостерігається, при цьому шукаються «падіння» в отриманій 
кривій блиску. Одним із недоліків цього методу є те, що транзити можна спостерігати лише тоді, коли орбіта планети 
ідеально вирівняна відносно місця розташування спостерігача. Інша проблема – високий рівень хибних виявлень, тому 
відкриття потребують підтвердження альтернативними методами.

### Місія 

NASA Kepler та її друга програма огляду K2 стали значним кроком вперед у створенні величезного каталогу систем екзопланет. 
Однак, процес підтвердження кандидатів, виявлених у місії Kepler, досі триває, оскільки виключення хибнопозитивних 
виявлень займає багато часу. У квітні 2018 року NASA запустило Transiting Exoplanet Survey Satellite (TESS) як наступника 
Kepler. TESS охоплює область, яка в 400 разів більша за ту, що охоплена Kepler, і спостерігає зірки, які в 30–100 разів 
яскравіші. Першим кроком в аналізі спостережуваних кривих блиску є пошук періодичних сигналів, так званих подій перетину 
порогу (TCE). Потім ці TCE перевіряються для усунення помилково вибраних несигналів, або вручну людьми, або 
автоматизованим способом.

Одним із найбільш часто використовуваних методів є метод найменших квадратів підгонки боксу (BLS). Проте, BLS обмежений 
з точки зору відношення сигнал/шум і вразливий до хибнопозитивних виявлень. Kepler, TESS та інші огляди все ще 
покладаються на ручний аналіз, який може призвести до розбіжностей між експертами. З цих причин потрібні системи, 
які можуть надійно та повторювано вибирати кандидатів у планети.

Протягом останніх років зростає інтерес до створення автоматичних систем перевірки за допомогою методів машинного 
навчання. Останнім часом дослідження відійшли від класичних методів машинного навчання, і методи глибокого навчання 
стали новим фокусом , зокрема архітектура AstroNet. Однак, моделі глибокого навчання зазвичай дорогі з точки зору 
обчислень і вимагають великих обсягів даних.

З цією мотивацією, у цій статті ми пропонуємо новий напрямок для вирішення проблеми пошуку екзопланет у даних кривих 
блиску за допомогою класичного машинного навчання.

## 2. МЕТОДИ
Ми створюємо бінарний класифікатор , заснований на класичному машинному навчанні. На відміну від глибокого навчання, 
наш підхід вимагає, щоб ознаки були розраховані заздалегідь. Для цього ми використовуємо бібліотеку TSFRESH на основі 
PYTHON для виділення ознак часових рядів.

#### Ми навчали та тестували нашу модель на трьох наборах даних:
- Симульовані дані: фотометрія K2 Кампанії 7 з штучно введеними транзитами. Ми видалили зоряну мінливість та обробили дані, 
щоб імітувати реалістичні сценарії, включаючи випадки з низьким S/N.

- Дані Kepler: Загальнодоступний набір даних, який використовувався для моделі AstroNet. Криві блиску були класифіковані 
як «кандидат у планети» (PC) та «не кандидат».

- Дані TESS: Загальнодоступний набір даних, наданий для мережі AstroNet-Vetting. Дані були класифіковані на PC, 
затьмарююча подвійна (EB) та сміття (J), а потім об'єднані в PC (клас 1) та не кандидат (клас 0).


### 2.2 Виділення ознак
Криві блиску передискретизовуються до частоти 1 година для забезпечення рівномірного розподілу точок даних у часі. 
Ми використали TSFRESH для виділення близько 790 узагальнених ознак часових рядів. Після виділення ознак ми видалили 
нерелевантні ознаки, імпетували відсутні значення та масштабували весь набір даних.

### 2.3 Навчання моделі
Ми використали модель градієнтного бустингу дерев (GBT) за допомогою фреймворку lightGBM як бінарний класифікатор. 
Для навчання використовувалася 10-кратна перехресна перевірка (CV).

### Метрики оцінки:
- Точність (Accuracy): Частка правильно класифікованих зразків.
- Точність (Precision): Частка прогнозованих «кандидатів у планети», які є справжніми планетами.
- Повнота (Recall): Частка справжніх планет, правильно виявлених класифікатором.
(Найважливіша метрика для виявлення планет).
- AUC: Площа під кривою ROC.
(Використовується для оптимізації гіперпараметрів).

Ми оптимізували гіперпараметри, щоб максимізувати AUC , а потім оптимізували поріг рішення (наприклад, p threshold
​ =0.13 замість стандартного 0.5) для досягнення високої повноти при збереженні прийнятної точності.

## 3. РЕЗУЛЬТАТИ
### 3.1 Симульовані дані
Наш метод перевершив BLS на симульованих даних:

|Тип	|AUC	|Повнота	|Точність|
|:------|------:|----------:|-------:|
|Наш метод	|0.97	|0.94	|0.92|
|BLS	|0.87	|0.86	|0.80|


Наш метод зміг виявити планети навіть у випадках із низьким S/N, які були пропущені BLS. Це демонструє, що наш метод 
може виявляти планети точніше та ефективніше, ніж BLS.

### 3.2 Дані Kepler
Наші результати були порівнянні з результатами AstroNet (Shallue & Vanderburg 2018):

|Тип	|AUC	|Повнота	|Точність|
|:------|------:|----------:|-------:|
|AstroNet	|0.952|	0.95|	0.84|
|Наш метод	|0.948|	0.96|	0.82|

Наша модель має трохи нижчий AUC , але вищу повноту , що відповідає нашій меті — ідентифікувати якомога більше 
кандидатів у планети. Аналіз t-SNE показав, що більшість кривих блиску, що містять транзит, кластеризовані в одній 
області, що підтверджує якість нашого виділення ознак.


### 3.3 Дані TESS
Криві блиску TESS відрізняються від Kepler, оскільки TESS спостерігав кожен сектор лише 27 днів , що призводить до 
меншої кількості точок даних з транзитами та високої незбалансованості класів (лише 3 відсотки кривих блиску є PC).

Порівняння з AstroNet-Vetting (Yu et al. 2019) з оптимальним порогом:

|Тип	|AUC	|Повнота	|Точність|
|:------|------:|----------:|-------:|
|Yu et al. (2019)	|0.98	|0.89|	0.45|
|Наш метод	|0.81	|0.82	|0.63|

Наш метод продемонстрував вищу точність (Precision) , що призведе до майже половини хибнопозитивних результатів 
порівняно з AstroNet-Vetting. Продуктивність для набору даних TESS є значно гіршою порівняно з Kepler через високу 
незбалансованість класів.

## 4. ОБГОВОРЕННЯ
### 4.1 Класичне машинне навчання проти глибокого навчання
Наш підхід класичного машинного навчання має такі переваги над сучасними методами глибокого навчання: 
- Вища ефективність: Навчання займає менше 5 хвилин на системі з 2 процесорами, тоді як глибоке навчання може 
зайняти більше 5 годин.
- Адаптивність: Може використовуватись той самий код для даних із різних джерел (Kepler, K2, TESS).
- Інтерпретованість: Найважливіші ознаки можуть бути ідентифіковані автоматично, що дозволяє краще зрозуміти дані; 
моделі глибокого навчання є «чорними ящиками».
- Простіша вимога до даних: Працює лише з глобальним виглядом кривої блиску.
- Обладнання: Не потрібне спеціальне обладнання, наприклад, GPU.
- Недоліки: Загалом, продуктивність нижча , і потрібне попереднє виділення ознак із даних часових рядів.

### 4.2 Інструмент перевірки
Методи машинного навчання не можуть повністю замінити експертів з ручної перевірки , але можуть допомогти автоматизувати 
процеси. Ми розробили інтерактивний інструмент перевірки, розміщений на GitHub: https://github.com/abhmalik/Exoplanet-Vetting-Tool

Інструмент дозволяє користувачеві переглядати криву блиску в глобальному та згорнутому виглядах, а також надає список 
ознак, важливих для прогнозу моделі.

### 4.3 Майбутні кроки

- Глобальний класифікатор: Можливо створити глобальний класифікатор, який може безпосередньо обробляти криві блиску 
будь-якої довжини з будь-якого джерела даних.
- Баланс класів TESS: Зі збільшенням підтверджених планет TESS можна буде створити набір даних із кращим балансом класів, 
що покращить продуктивність.
- Напівкерований підхід: Дослідження можливості переходу до напівкерованого підходу, включаючи вбудовування даних у 
нижчий розмірний простір та кластеризацію.

## 5. ВИСНОВКИ
Методи машинного навчання є невід'ємною частиною нашого способу роботи. Вони широко використовуються в науках. 
Наша робота забезпечує новий напрямок для легкої та ефективної автоматичної системи перевірки